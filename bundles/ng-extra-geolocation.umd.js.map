{"version":3,"file":"ng-extra-geolocation.umd.js","sources":["../../src/ng-extra/geolocation/geolocation-module.ts","../../src/ng-extra/geolocation/geolocation.ts"],"sourcesContent":["/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {NgModule} from '@angular/core';\n\nimport {Geolocation} from './geolocation';\n\n@NgModule({\n  providers: [Geolocation]\n})\nexport class GeolocationModule {}\n","/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {Injectable} from '@angular/core';\n\nimport {Observable} from 'rxjs/Observable';\nimport {interval} from 'rxjs/observable/interval';\nimport {mergeMap} from 'rxjs/operators/mergeMap';\n\n\n/**\n * Service to get or watch current position (geolocation)\n */\n@Injectable()\nexport class Geolocation {\n  /** Whether the HTML5 Geolocation API is available */\n  readonly geolocationAvailable: boolean;\n\n  constructor() {\n    this.geolocationAvailable = typeof navigator !== 'undefined' &&\n      typeof navigator.geolocation !== 'undefined';\n  }\n\n  /**\n   * Gets a stream that emits when the current position is acquired via\n   * the HTML5 Geolocation API\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @returns A stream of the acquired position\n   */\n  getCurrentPosition(options?: PositionOptions): Observable<Position> {\n    return new Observable<Position>(subscriber => {\n      if (!this.geolocationAvailable) {\n        subscriber.error();\n      }\n      navigator.geolocation.getCurrentPosition(\n        position => {\n          subscriber.next(position);\n          subscriber.complete();\n        },\n        err => {\n          subscriber.error(err);\n        },\n        options\n      );\n    });\n  }\n\n  /**\n   * Gets a stream that emits when the position acquired via\n   * the HTML5 Geolocation API at intervals of `intervalMs` milliseconds\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @param intervalMs Milliseconds between each position acquisition\n   * @returns A stream of the acquired position\n   */\n  watchPosition(options?: PositionOptions, intervalMs: number = 1000): Observable<Position> {\n    return interval(intervalMs).pipe(\n      mergeMap(() => this.getCurrentPosition(options))\n    );\n  }\n}\n"],"names":["NgModule","Injectable","interval","mergeMap","Observable"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICmCE,SAAF,WAAA,GAAA;QACI,IAAI,CAAC,oBAAoB,GAAG,OAAO,SAAS,KAAK,WAAW;YAC1D,OAAO,SAAS,CAAC,WAAW,KAAK,WAAW,CAAC;KAChD;;;;;;;;;;;;;IAQD,WAAF,CAAA,SAAA,CAAA,kBAAoB;;;;;;IAAlB,UAAmB,OAAyB,EAA9C;QAAE,IAAF,KAAA,GAAA,IAAA,CAgBG;QAfC,OAAO,IAAII,0BAAU,CAAW,UAAA,UAAU,EAA9C;YACM,IAAI,CAAC,KAAI,CAAC,oBAAoB,EAAE;gBAC9B,UAAU,CAAC,KAAK,EAAE,CAAC;aACpB;YACD,SAAS,CAAC,WAAW,CAAC,kBAAkB,CACtC,UAAA,QAAQ,EADhB;gBAEU,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC1B,UAAU,CAAC,QAAQ,EAAE,CAAC;aACvB,EACD,UAAA,GAAG,EADX;gBAEU,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;aACvB,EACD,OAAO,CACR,CAAC;SACH,CAAC,CAAC;KACJ,CAAH;;;;;;;;;;;;;;;IASE,WAAF,CAAA,SAAA,CAAA,aAAe;;;;;;;IAAb,UAAc,OAAyB,EAAE,UAAyB,EAApE;QAAE,IAAF,KAAA,GAAA,IAAA,CAIG;QAJwC,IAA3C,UAAA,KAAA,KAAA,CAAA,EAA2C,EAAA,UAA3C,GAAA,IAAoE,CAApE,EAAA;QACI,OAAOF,iCAAQ,CAAC,UAAU,CAAC,CAAC,IAAI,CAC9BC,gCAAQ,CAAC,YADf,EACqB,OAAA,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CADrD,EACqD,CAAC,CACjD,CAAC;KACH,CAAH;;QA7CA,EAAA,IAAA,EAACF,wBAAU,EAAX;;;;IA9BA,OAAA,WAAA,CAAA;CA+BA,EAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;ADXA,IAAA,iBAAA,kBAAA,YAAA;;;;QAIA,EAAA,IAAA,EAACD,sBAAQ,EAAT,IAAA,EAAA,CAAU;oBACR,SAAS,EAAE,CAAC,WAAW,CAAC;iBACzB,EAAD,EAAA;;;;IA1BA,OAAA,iBAAA,CAAA;CA2BA,EAAA,CAAA,CAAA;;;;;;;"}