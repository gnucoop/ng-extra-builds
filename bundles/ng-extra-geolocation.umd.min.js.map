{"version":3,"file":"ng-extra-geolocation.umd.min.js","sources":["../../src/ng-extra/geolocation/geolocation.ts","../../src/ng-extra/geolocation/geolocation-module.ts"],"sourcesContent":["/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {Injectable} from '@angular/core';\n\nimport {Observable} from 'rxjs/Observable';\nimport {interval} from 'rxjs/observable/interval';\nimport {mergeMap} from 'rxjs/operators/mergeMap';\n\n\n/**\n * Service to get or watch current position (geolocation)\n */\n@Injectable()\nexport class Geolocation {\n  /** Whether the HTML5 Geolocation API is available */\n  readonly geolocationAvailable: boolean;\n\n  constructor() {\n    this.geolocationAvailable = typeof navigator !== 'undefined' &&\n      typeof navigator.geolocation !== 'undefined';\n  }\n\n  /**\n   * Gets a stream that emits when the current position is acquired via\n   * the HTML5 Geolocation API\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @returns A stream of the acquired position\n   */\n  getCurrentPosition(options?: PositionOptions): Observable<Position> {\n    return new Observable<Position>(subscriber => {\n      if (!this.geolocationAvailable) {\n        subscriber.error();\n        return;\n      }\n      navigator.geolocation.getCurrentPosition(\n        position => {\n          subscriber.next(position);\n          subscriber.complete();\n        },\n        err => {\n          subscriber.error(err);\n        },\n        options\n      );\n    });\n  }\n\n  /**\n   * Gets a stream that emits when the position acquired via\n   * the HTML5 Geolocation API at intervals of `intervalMs` milliseconds\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @param intervalMs Milliseconds between each position acquisition\n   * @returns A stream of the acquired position\n   */\n  watchPosition(options?: PositionOptions, intervalMs: number = 1000): Observable<Position> {\n    return interval(intervalMs).pipe(\n      mergeMap(() => this.getCurrentPosition(options))\n    );\n  }\n}\n","/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {NgModule} from '@angular/core';\n\nimport {Geolocation} from './geolocation';\n\n@NgModule({\n  providers: [Geolocation]\n})\nexport class GeolocationModule {}\n"],"names":["Geolocation","this","geolocationAvailable","navigator","geolocation","prototype","getCurrentPosition","options","_this","Observable","subscriber","error","position","next","complete","err","watchPosition","intervalMs","interval","pipe","mergeMap","type","Injectable","GeolocationModule","NgModule","args","providers"],"mappings":"0jBAmCE,QAAFA,KACIC,KAAKC,qBAA4C,mBAAdC,gBACA,KAA1BA,UAAUC,YArCvB,MA8CEJ,GAAFK,UAAAC,mBAAE,SAAmBC,GAAnB,GAAFC,GAAAP,IACI,OAAO,IAAIQ,GAAAA,WAAqB,SAAAC,GAC9B,IAAKF,EAAKN,qBAER,WADAQ,GAAWC,OAGbR,WAAUC,YAAYE,mBACpB,SAAAM,GACEF,EAAWG,KAAKD,GAChBF,EAAWI,YAEb,SAAAC,GACEL,EAAWC,MAAMI,IAEnBR,MAYNP,EAAFK,UAAAW,cAAE,SAAcT,EAA2BU,GAAzC,GAAFT,GAAAP,IACI,YADJ,KAAAgB,IAA2CA,EAA3C,KACWC,EAAAA,SAASD,GAAYE,KAC1BC,EAAAA,SAAS,WAAM,MAAAZ,GAAKF,mBAAmBC,sBA5C7Cc,KAACC,EAAAA,mDA9BDtB,KCoBAuB,EAAA,yBApBA,sBAwBAF,KAACG,EAAAA,SAADC,OACEC,WAAY1B,6CAzBduB"}