{"version":3,"file":"geolocation.js","sources":["../../../src/ng-extra/geolocation/index.ts","../../../src/ng-extra/geolocation/public-api.ts","../../../src/ng-extra/geolocation/geolocation-module.ts","../../../src/ng-extra/geolocation/geolocation.ts"],"sourcesContent":["/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n","/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nexport * from './geolocation';\nexport * from './geolocation-module';\n","/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {NgModule} from '@angular/core';\n\nimport {Geolocation} from './geolocation';\n\n@NgModule({\n  providers: [Geolocation]\n})\nexport class GeolocationModule {}\n","/**\n * Copyright (C) 2018 Gnucoop soc. coop.\n * \n * This file is part of ng-extra.\n * \n * ng-extra is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n * \n * ng-extra is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with ng-extra.  If not, see <http://www.gnu.org/licenses/>.\n * \n */\n\nimport {Injectable} from '@angular/core';\n\nimport {Observable} from 'rxjs/Observable';\nimport {interval} from 'rxjs/observable/interval';\nimport {mergeMap} from 'rxjs/operators/mergeMap';\n\n\n/**\n * Service to get or watch current position (geolocation)\n */\n@Injectable()\nexport class Geolocation {\n  /** Whether the HTML5 Geolocation API is available */\n  readonly geolocationAvailable: boolean;\n\n  constructor() {\n    this.geolocationAvailable = navigator != null && navigator.geolocation != null;\n  }\n\n  /**\n   * Gets a stream that emits when the current position is acquired via\n   * the HTML5 Geolocation API\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @returns A stream of the acquired position\n   */\n  getCurrentPosition(options?: PositionOptions): Observable<Position> {\n    return new Observable<Position>(subscriber => {\n      if (!this.geolocationAvailable) {\n        subscriber.error();\n      }\n      navigator.geolocation.getCurrentPosition(\n        position => {\n          subscriber.next(position);\n          subscriber.complete();\n        },\n        err => {\n          subscriber.error(err);\n        },\n        options\n      );\n    });\n  }\n\n  /**\n   * Gets a stream that emits when the position acquired via\n   * the HTML5 Geolocation API at intervals of `intervalMs` milliseconds\n   * @param options Option properties to pass as a parameter of Geolocation.getCurrentPosition()\n   * @param intervalMs Milliseconds between each position acquisition\n   * @returns A stream of the acquired position\n   */\n  watchPosition(options?: PositionOptions, intervalMs: number = 1000): Observable<Position> {\n    return interval(intervalMs).pipe(\n      mergeMap(() => this.getCurrentPosition(options))\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGoBA,AAEA,AACA,AACA;;;AAOA,AAAA,MAAA,WAAA,CAAA;IAIE,WAAF,GAAA;QACI,IAAI,CAAC,oBAAoB,GAAG,SAAS,IAAI,IAAI,IAAI,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC;KAChF;;;;;;;IAQD,kBAAkB,CAAC,OAAyB,EAA9C;QACI,OAAO,IAAI,UAAU,CAAW,UAAU,IAA9C;YACM,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;gBAC9B,UAAU,CAAC,KAAK,EAAE,CAAC;aACpB;YACD,SAAS,CAAC,WAAW,CAAC,kBAAkB,CACtC,QAAQ,IADhB;gBAEU,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC1B,UAAU,CAAC,QAAQ,EAAE,CAAC;aACvB,EACD,GAAG,IADX;gBAEU,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;aACvB,EACD,OAAO,CACR,CAAC;SACH,CAAC,CAAC;KACJ;;;;;;;;IASD,aAAa,CAAC,OAAyB,EAAE,UAA3C,GAAgE,IAAI,EAApE;QACI,OAAO,QAAQ,CAAC,UAAU,CAAC,CAAC,IAAI,CAC9B,QAAQ,CAAC,MAAM,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CACjD,CAAC;KACH;;;IA5CH,EAAA,IAAA,EAAC,UAAU,EAAX;;;;;;;;;;;;;;;;;;;;;;;;;;;;ADVA,AAEA,AAKA,AAAA,MAAA,iBAAA,CAAA;;;IAHA,EAAA,IAAA,EAAC,QAAQ,EAAT,IAAA,EAAA,CAAU;gBACR,SAAS,EAAE,CAAC,WAAW,CAAC;aACzB,EAAD,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;GDNA,AACA,AAAqC;;;;;;;;GDjBrC,AAA6B;;"}